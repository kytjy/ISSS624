---
title: "Take-home Exercise 1: Geospatial Analytics for Public Good"
date: "23 November 2023"
date-modified: "last-modified"
format: html
execute:
  echo: true #all the codes will appear
  eval: true #all the codes will run
  warning: false #dont display if there are any warnings
editor: visual
---

# 1 Overview

## 1.1 Background

As urban infrastructures, including public transportation systems like buses, taxis, mass rapid transit, public utilities, and roads, become increasingly digitised, the data generated becomes a valuable resource for tracking the movements of people and vehicles over space and time. This transformation has been facilitated bypervasive computing technologies such as Global Positioning System (GPS) and Radio Frequency Identification (RFID) tags on vehicles. An example of this is the collection of data on bus routes and ridership, amassed from the use of smart cards and GPS devices available on public buses.

The data collected from these sources is likely to contain valuable patterns that offer insights into various aspects of human movement and behavior within a city. Analyzing and comparing these patterns can provide a deeper understanding of urban mobility. Such insights can be instrumental in improving urban management and can also serve as valuable information for both public and private sector stakeholders involved in urban transportation services. This information can aid them in making informed decisions and gaining a competitive edge in their respective domains.

## 1.2 Objectives

::: panel-tabset
## Aim

The objective of this study is to utilize appropriate Local Indicators of Spatial Association (LISA) and Emerging Hot Spot Analysis (EHSA) techniques to **uncover spatial and spatio-temporal mobility patterns among public bus passengers in Singapore**.

## Tasks

This will include the following tasks:

-   Geovisualisation and Analysis:
    -   Compute the passenger trips generated by origin at the hexagon level with reference to the time intervals:

| Peak hour period             | Bus tap on time |
|------------------------------|-----------------|
| Weekday morning peak         | 6am to 9am      |
| Weekday afternoon peak       | 5pm to 8pm      |
| Weekend/holiday morning peak | 11am to 2pm     |
| Weekend/holiday evening peak | 4pm to 7pm      |

```         
-   Display the geographical distribution of the passenger trips
-   Explore spatial patterns revealed by the geovisualisation
```

-   Local Indicators of Spatial Association (LISA) Analysis
    -   Compute LISA of the passenger trips generate by origin
    -   Display and draw statistical conclusions of LISA maps
-   Emerging Hot Spot Analysis (EHSA)
    -   Perform Mann-Kendall Test by using the spatio-temporal local Gi\* values
    -   Display EHSA maps of the Gi\* values, describe the spatial patterns revealed
:::

# 2 Loading Packages

::: panel-tabset
## Packages

The following packages will be used for this exercise:

-   sf for importing, managing, and handling geospatial data,
-   tidyverse for non-spatial data handling,
-   sfdep will be used to compute spatial weights, global and local spatial autocorrelation statistics, and
-   tmap for thematic mapping.

## Code

The code chunk below ensures that **sfdep**, **sf**, **tmap** and **tidyverse** packages are installed and loaded in R.

```{r}
pacman::p_load(sf, sfdep, tmap, tidyverse)

# -   Creates a package list containing the necessary R packages
# -   Checks if the R packages in the package list have been installed
# -   If not installed, will install the missing packages & launch into R environment.
```
:::

# 3 **Data Preparation**

## The Data

The following data are used for this study:

-   Aspatial:
    -   *Passenger Volume by Origin Destination Bus Stops* for August, September and October 2023, downloaded from [LTA DataMall](https://datamall.lta.gov.sg/content/datamall/en/dynamic-data.html) using [API](https://datamall.lta.gov.sg/content/dam/datamall/datasets/LTA_DataMall_API_User_Guide.pdf).
-   Geospatial
    -   *Bus Stop Location* from [LTA DataMall](https://datamall.lta.gov.sg/content/datamall/en/static-data.html). It provides information about all the bus stops currently being serviced by buses, including the bus stop code (identifier) and location coordinates.
    -   *hexagon*, a [hexagon](https://desktop.arcgis.com/en/arcmap/latest/tools/spatial-statistics-toolbox/h-whyhexagons.htm) layer of 250m is provided to replace the relative coarse and irregular Master Plan 2019 Planning Sub-zone GIS data set of URA.

## Import & Preparation

::: panel-tabset
## Aspatial

Firstly, we will import the *Passenger Volume by Origin Destination Bus Stops* dataset downloaded from LTA DataMall by using `read_csv()` or **readr** package.

```{r}
odbus <- read_csv("data/aspatial/origin_destination_bus_202308.csv")
```

Prima facie, ORIGIN_PT_CODE and DESTINATON_PT_CODE in the odbus tibble data frame are in numeric data type.

```{r}
glimpse(odbus)
```

## Geospatial
:::

# 4 Exploratory Data Analysis

# 5 Exploratory Spatial Data Analysis

# 6 Conclusion
